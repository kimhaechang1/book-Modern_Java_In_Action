## 기존의 자바는 멀티코어를 재대로 활용하지 못했다.

자바 코드는 멀티코어를 재대로 활용하지 못하고, 단일 코어를 갈구는 프로그램이었을 것이다.

여기서 나머지 코어를 활성화 하기위해 자바 1.0 부터 저수준의 API와 쓰레드를 지원했고

그렇게 쓰레드를 사용하니 갯수와 관리가 힘들어서 자바 5에 스레드 풀이 추가 되었다.

또한 자바 7에서 병렬 프로그래밍을 위한 포크/조인 풀을 제공하였다.

그런데도 자바를 사용해서 개발하는 개발자 입장에서 병렬 실행을 하기 힘들었다.

### 하드웨어 스레드

https://shuu.tistory.com/81

우리가 보통 CPU 스펙을 보면 몇코어 몇 스레드란 말이 있다.

그런데 대부분의 경우 코어수 \* 2 = 스레드 수라고 스펙이 잡혀있는 경우가 많다.

이는 제조사 마다 다르나(AMD의 경우 SMT, 인텔의 경우 HT),

가상의 스레드라는개념이 추가되어 1코어 2스레드로 구성되게 된다.

운영체제 입장에서는 해당 스레드도 가상의 코어로 보인다.

즉, 10코어 20 스레드의 스펙이라면, OS 입장에서는 20개의 논리적인 코어로 인식한다.

### 사용자 수준의 스레드

프로그래밍으로 추상화된 스레드를 사용한다.

운영체제 입장에서는 프로세스 단일로 보이나, 운영체제의 스레드를 사용자 스레드들이 번갈아가면서 사용한다.

추상화된 라이브러리를 통해 사용자가 직접 쓰레드를 생성하고, 라이브러리의 스케쥴링 알고리즘을 통해 커널 스레드의 자원을 획득하게 된다.

위의 모델의 최대 단점은 점유하고 있는 스레드 하나가 블록 I/O를 진행하는 경우 해당 커널 스레드에 물려있는 다른 사용자 스레드는 모두 정지되게 된다.

1 to N 모델이라고도 부른다.

### 커널 수준 스레드

운영체제 내 여러 스레드들과 사용자 스레드가 1:1로 매핑되는 형태

기존에 사용자 수준의 스레드에서 사용하는 스레드 라이브러리에서 스케쥴링 및 스레드 메모리 할당등을 담당하였지만

운영체제 수준으로 위임된 형태는 운영체제의 CPU 스케쥴링에 따라 스레드가 활성화 된다.

1 to 1 모델이라고 부른다.

### 혼합형 스레드

사용자 수준 스레드와 커런 수준 스레드를 혼합한 형태

다수의 사용자 수준 스레드에 다수의 커널 스레드가 다대다 형태로 매핑된다.

사용자 수준 스레드는 커널 수준 스레드와 비슷하 경량 프로세스에 매핑되고

경량 프로세스는 커널 수준 스레드와 1대1로 매핑된다.
